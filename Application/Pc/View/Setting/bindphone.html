	<include file="Base:header" />
	<title data-n-head="true">绑定手机号</title>
	<link href="__PUBLIC__/Qts/Home/css/common.css" rel="stylesheet">
	<style data-vue-ssr-id="4cddb420:0 cf79f97a:0">
		
		
		.login_footers > div[data-v-2d3e0ef2]:first-of-type {
			float: left
		}
		
		.login_footers > div[data-v-2d3e0ef2]:nth-of-type(2) {
			position: relative;
			float: right;
			color: #ffbf23;
			padding-right: .15rem
		}
		
		label[data-v-4221f031] {
			display: block
		}
		
		.form[data-v-4221f031] {
			font-size: .14rem;
			padding: 0 .14rem;
			background: #171520;
		}
		
		.form > div[data-v-4221f031] {
			height: .5rem;
			line-height: .5rem
		}
		
		input[data-v-4221f031] {
			height: .3rem;
			line-height: .3rem
		}
		
		.form-item1[data-v-4221f031], .form-item2[data-v-4221f031] {
			position: relative
		}
		
		.form-item1 > dl[data-v-4221f031] {
			width: .16rem;
			height: .16rem;
			position: absolute;
			top: .17rem;
			right: .14rem
		}
		
		.btnYzm[data-v-4221f031] {
			color: #ddd;
			position: absolute;
			right: .14rem;
			top: 0
		}
		
		.form > .exitOut[data-v-4221f031] {
			height: .4rem;
			line-height: .4rem;
			color: #000;
			font-size: .16rem;
			margin-top: .4rem;
			margin: .4rem .14rem 0;
			text-align: center;
			border-radius: 0.05rem;
			background: #ffbf23;
		}
		
		.form-item1[data-v-4221f031]:before, .form-item2[data-v-4221f031]:before {
			content: "";
			position: absolute;
			width: 200%;
			bottom: 0;
			border-bottom: 1px solid #e2e5e8;
			-webkit-transform-origin: 0 0;
			-ms-transform-origin: 0 0;
			transform-origin: 0 0;
			-webkit-transform: scale(.5);
			-ms-transform: scale(.5);
			transform: scale(.5);
			-webkit-box-sizing: border-box;
			box-sizing: border-box
		}
		
		.form[data-v-525c5c54] {
			padding: 0 .14rem;
			font-size: .14rem;
			background: #fff
		}
		
		.form > div[data-v-525c5c54] {
			height: .45rem;
			line-height: .45rem
		}
		
		.form input[data-v-525c5c54] {
			height: .3rem;
			line-height: .3rem;
			width: 80%
		}
		
		.form-item1[data-v-525c5c54]:before, .form-item2[data-v-525c5c54]:before {
			content: "";
			position: absolute;
			width: 200%;
			bottom: 0;
			border-bottom: 1px solid #e2e5e8;
			-webkit-transform-origin: 0 0;
			-ms-transform-origin: 0 0;
			transform-origin: 0 0;
			-webkit-transform: scale(.5);
			-ms-transform: scale(.5);
			transform: scale(.5);
			-webkit-box-sizing: border-box;
			box-sizing: border-box
		}
		
		.form-item1[data-v-525c5c54], .form-item2[data-v-525c5c54] {
			position: relative
		}
		
		.form-item1 > dl[data-v-525c5c54] {
			width: .16rem;
			height: .16rem;
			position: absolute;
			top: .17rem;
			right: .14rem
		}
		
		.form-item2 > p[data-v-525c5c54] {
			top: .2rem;
			right: 0
		}
		
		label[data-v-7ccdb03b] {
			display: block;
			border-bottom: 1px solid #e2e5e8
		}
		
		input[data-v-7ccdb03b] {
			display: block;
			line-height: .5rem;
			top: .2rem;
			width: 80%;
			-webkit-box-sizing: border-box;
			box-sizing: border-box
		}
		
		label .icon_s[data-v-7ccdb03b] {
			position: absolute;
			display: block;
			right: 0;
			top: .15rem;
			background-size: 100%
		}
		
		p[data-v-7ccdb03b] {
			padding: .09rem .14rem .47rem;
			color: #999;
			font-size: .12rem
		}
		
		span[data-v-7ccdb03b] {
			color: #f7b059
		}
		.newyzmColor[data-v-4221f031], .yzmColor[data-v-4221f031] {
			color: #ffbf23;
		}
		.btnColor, .newbtnColor{
			/*background-image: -o-linear-gradient(319deg,#1254a8 0,#0c62c1 100%)!important;*/
			/*background-image: linear-gradient(-229deg,#1254a8,#0c62c1)!important;*/
			background: #ffbf23;
			color: #000;
		}
		body {
			background: #ffffff
		}</style>
</head>
<body class="">
<div id="__nuxt">
	<div class="progress" data-v-4a8a9a01=""
	     style="width: 0%; height: 2px; background-color: rgb(1, 40, 97); opacity: 0;"></div>
	<div data-v-4221f031="" class="content">
		<div data-v-4221f031="" id="head">
			<div class="head_content"><h3 class="product-name"><span>绑定手机号</span><em></em></h3>
				<div class="left" onclick="window.history.back()"><a class="arrow_left"></a></div>
				<div class="right arrow_right"><b></b></div>
			</div>
		</div>
		<section data-v-4221f031="" class="page-main">
			<div data-v-4221f031="" class="form">

				<div data-v-4221f031="" style="color: rgb(153, 153, 153);">修改绑定手机号前请先验证原手机号</div>

				<div data-v-4221f031="" class="form-item1">
					<input data-v-4221f031="" type="text" name="" value="{$phone}" placeholder="输入原手机号" readonly="readonly">
				</div>

				<div data-v-4221f031="" class="form-item2">
					<label data-v-4221f031="">
						<input data-v-4221f031="" type="tel" maxlength="6" placeholder="验证码" id="smscode">
						<p data-v-4221f031="" class="btnYzm yzmColor">获取验证码</p>
					</label>
				</div>

				<div data-v-4221f031="" class="exitOut" onclick="submit();" >下一步</div>
			</div>
		</section>
	</div>
</div>
<script src="__PUBLIC__/Qts/Home/js/jquery.js"></script>
<script type="text/javascript" src="__PUBLIC__/Home/css/layer/layer.js"></script>
<script>
    $('.btnYzm').bind('click',getCode)
    function getCode(){

        var  mobile = "{$mobile}";
        get_phones_code(mobile);
    }


    function get_phones_code(mobile){

        var index = layer.load(2);
        $.ajax({
            url:"{:U('Tools/outpwd_smsverify')}",
            dataType: 'json',
            type: 'get',
            data: {'mobile':mobile},
            success:function(data){

                if(data.ret_code == 200){

                    layer.close(index);      
                    layer.msg(data.ret_msg);
                    return mbtime();
                } else{
                    layer.close(index);
                    return layer.msg(data.ret_msg);
                }
            }
        });
    }

    function mbtime()
    {
        var s=60;
        var timer=setInterval(function () {
            s--;
            $('.btnYzm').html(s+'秒').removeClass('yzmColor');
            $('.btnYzm').unbind('click');
            if(s==0){
                $('.btnYzm').html('获取验证码').addClass('yzmColor');
                $('.btnYzm').bind('click',getCode)
                clearInterval(timer)
                timer=null;
            }
        },1000)
    }


    function submit()
    {
        var index   = layer.load(2);

        var mobile      = "{$mobile}";
        var smscode     = $('#smscode').val();

        $.ajax({
            url:"{:U('verifMobile')}",
            dataType: 'json',
            type: 'post',
            data: {'mobile':mobile,'smscode':smscode},
            success:function(data){

                if(data.code == 200){

                    layer.close(index);
                    return window.location.href="{:U('BindNewMobile')}?sms_token="+data.sms_token+"";
                } else{
                    layer.close(index);
                    return layer.msg(data.msg);
                }
            }
        });
    }

</script>
</body>
</html>